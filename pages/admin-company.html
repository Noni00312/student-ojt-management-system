<!DOCTYPE html>
<html lang="en">

  <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="/css/styles.css">
    <link rel="stylesheet" href="/css/admin-t-i-o-company.css">
    <link rel="stylesheet" href="/css/admin-company.css">
    <link rel="stylesheet" href="/css/bootstrap-icons.min.css">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css" rel="stylesheet"
      integrity="sha384-rbsA2VBKQhggwzxH7pPCaAqO46MgnOM80zW1RWuH61DGLwZJEdK2Kadq2F9CUG65" crossorigin="anonymous">
    <link rel="manifest" href="/manifest.json">
    <link rel="manifest" href="/manifest.json">
    <link rel="apple-touch-icon" href="/assets/img/icons/LOGO 96.png">
    <link rel="app-mobile-web-app-status-bar" href="#6e1423">
    <meta name="theme-color" content="#6e1423">

    <title>Companies | SOJTMS</title>
    <link rel="icon" type="image/png" href="/assets/img/logo trans.png">
  </head>

  <body class="main-container">

    
    <nav class="navbar navbar-expand-lg fixes-top accent-bg-color sticky-top">
      <div class="container ">
          <div class="d-flex align-items-center justify-content-between w-100">
            <div class="wrapper">
              <div class="d-flex align-items-center">
                <a href="" class="navbar-brand fw-bold text-white d-none d-lg-block">SOJTMS - Admin</a>
              </div>
              <button class="btn 	d-lg-none d-sm-block" type="button " data-bs-toggle="offcanvas" data-bs-target="#sideBar" aria-controls="sideBar">
                <i class="bi bi-list text-light fs-3 outline-none"></i>
              </button>
            </div>
  
            <div class="collapse navbar-collapse me-2" id="navbarSupportedContent">
              <ul class="navbar-nav ms-auto mb-2 mb-lg-0">
                <li class="nav-item">
                  <a class="nav-link text-light" aria-current="page" href="./admin-dashboard.html">Home</a>
                </li>
                <li class="nav-item">
                  <a class="nav-link text-light" aria-current="page" href="./admin-t-i-o.html">Time in/out</a>
                </li>
                <li class="nav-item">
                  <a class="nav-link text-light" aria-current="page" href="./admin-company.html">Companies</a>
                </li>
                <li class="nav-item">
                  <a class="nav-link text-light" aria-current="page" href="./admin-student.html">Students</a>
                </li>
                <li class="nav-item">
                  <a class="nav-link text-light" aria-current="page" href="./admin-assistant.html">Assistants</a>
                </li>
                <li class="nav-item">
                  <a class="nav-link text-light" aria-current="page" href="./admin-incident-report.html">Incident Report</a>
                </li>
              </ul>
            </div>
            <a href="/pages/admin-profile.html" id="user-profile" class=" text-decoration-none">
              <img src="/assets/img/icons8_male_user_480px_1.png" alt="User profile icon" loading="lazy" id="user-img" style="border-radius: 50%;">
            </a>
      </div>
  </nav>

    
    <section class="container mt-2 d-flex flex-column  .reports-section">
      <h1 class="fw-bold" style="color: #3C3D42 !important;">COMPANIES</h1>

      <div class="add-search-container d-flex align-items-stretch">
        <form class="form-floating flex-grow-1 me-2">

          <div class="search-input position-relative w-100">
            <i class="bi bi-search position-absolute top-50 end-0 translate-middle me-2"></i>
            <input type="text" id="companySearch" class="form-control py-2" style="height: 58px; border-radius: 30px !important;"
              placeholder="Search companies...">
          </div>
        </form>

        <button class="d-flex align-items-center justify-content-center" style="width: 80px;" data-bs-toggle="modal"
          data-bs-target="#addCompanyModal">
          <i class="bi bi-plus-lg"></i>
        </button>
      </div>

      <div class="row card-container mt-2 w-100 align-self-center">

        

      </div>

    </section>
    

   
    <div class="modal fade" id="addCompanyModal" data-bs-backdrop="static" tabindex="-1"
      aria-labelledby="addCompanyModal" aria-hidden="true">
      <div class="modal-dialog modal-lg">
        <div class="modal-content  pe-3 ps-3 add-company-modal">
          <div class="d-flex justify-content-between pt-4 pe-4 ps-4">
            <h4 class="modal-title" id="exampleModalLabel">Add Company</h4>
            <i class="bi bi-x-lg fs-6 text-white" data-bs-dismiss="modal" aria-label="Close"></i>
          </div>
          <form action="" method="post" id="ojtForm">
            <div class="modal-body">

              <div class="row d-flex align-items-center justify-content-center">



                
                <div class="col-md-12 d-flex justify-content-center position-relative">
                  <label for="camera-input" id="camera-button"
                    class="d-flex align-items-center justify-content-center mb-3"
                    style="width: 150px; height: 150px; border: 2px dashed #ccc; cursor: pointer;">
                    <i class="bi bi-image align-center" id="camera-icon" style="font-size: 2rem;"></i>
                    <img id="preview-image" src="" alt="Preview"
                      style="width: 100%; height: 100%; object-fit: cover; display: none;">
                  </label>
                  <input type="file" id="camera-input" accept="image/*" style="display: none;">
                </div>

                <div class="form-floating col-md-6 mt-3 ps-1 pe-1 position-relative modal-input">
                  <i class="bi bi-buildings-fill position-absolute top-50 end-0 me-3 translate-middle-y ms-3"></i>
                  <input type="text" class="form-control ps-3 pe-1" id="company-name" name="companyName"
                    placeholder="Enter company-name">
                  <label for="company-name">Company Name</label>
                  <span id="companyName-error" class="text-danger" style="font-size: 12px"></span>
                </div>

                <div class="form-floating col-md-6 mt-3 ps-1 pe-1 position-relative modal-input">
                  <i class="bi bi-geo-alt-fill position-absolute top-50 end-0 me-3 translate-middle-y ms-3"></i>
                  <input type="text" class="form-control ps-3 pe-1" id="company-address" name="companyAddress"
                    placeholder="Enter company address" required>
                  <label for="company-address">Company Address</label>
                  <span id="companyAddress-error" class="text-danger" style="font-size: 12px"></span>
                </div>
              </div>
            </div>

            <!-- Add this after the company address field -->
            <div class="form-floating col-md-6 mt-3 ps-1 pe-1 position-relative modal-input">
              <i class="bi bi-geo-alt-fill position-absolute top-50 end-0 me-3 translate-middle-y ms-3"></i>
              <input type="text" class="form-control ps-3 pe-1" id="company-province" name="companyProvince"
                placeholder="Enter company province" required>
              <label for="company-province">Company Province</label>
              <span id="companyProvince-error" class="text-danger" style="font-size: 12px"></span>
            </div>

            <div class="d-flex justify-content-center">
              <button type="submit" class="mt-2 mb-3 d-block add-company-button" id="add-company-button">
                <span>Add Company</span>
              </button>

            </div>
          </form>
        </div>
      </div>
    </div>
    





    
    <div class="modal fade" id="updateCompanyModal" data-bs-backdrop="static" tabindex="-1"
      aria-labelledby="updateCompanyModal" aria-hidden="true">
      <div class="modal-dialog modal-lg">
        <div class="modal-content pe-3 ps-3 update-company-modal">
          <div class="d-flex justify-content-between pt-4 pe-4 ps-4">
            <h4 class="modal-title" id="exampleModalLabel">Update Company</h4>
            <i class="bi bi-x-lg fs-6 text-white" data-bs-dismiss="modal" aria-label="Close"></i>
          </div>
          <form action="" method="post" id="ojtFormU">
            <div class="modal-body">
              <div class="row d-flex align-items-center justify-content-center">
                <div class="col-md-12 d-flex justify-content-center position-relative">
                  <label for="update-camera-input" id="update-camera-button"
                    class="d-flex align-items-center justify-content-center mb-3"
                    style="width: 150px; height: 150px; border: 2px dashed #ccc; cursor: pointer;">
                    <i class="bi bi-image align-center" id="update-camera-icon" style="font-size: 2rem;"></i>
                    <img id="update-preview-image" src="" alt="Preview"
                      style="width: 100%; height: 100%; object-fit: cover; display: none;">
                  </label>
                  <input type="file" id="update-camera-input" accept="image/*" style="display: none;">
                </div>

                <div class="form-floating col-md-6 mt-3 ps-1 pe-1 position-relative modal-input">
                  <i class="bi bi-buildings-fill position-absolute top-50 end-0 me-3 translate-middle-y ms-3"></i>
                  <input type="text" class="form-control ps-3 pe-1" id="update-company-name" name="companyNameU"
                    placeholder="Enter company-name">
                  <label for="update-company-name">Company Name</label>
                  <span id="companyNameU-error" class="text-danger" style="font-size: 12px"></span>
                </div>

                <div class="form-floating col-md-6 mt-3 ps-1 pe-1 position-relative modal-input">
                  <i class="bi bi-geo-alt-fill position-absolute top-50 end-0 me-3 translate-middle-y ms-3"></i>
                  <input type="text" class="form-control ps-3 pe-1" id="update-company-address" name="companyAddressU"
                    placeholder="Enter company address">
                  <label for="update-company-address">Company Address</label>
                  <span id="companyAddressU-error" class="text-danger" style="font-size: 12px"></span>
                </div>
              </div>
            </div>

            <div class="d-flex justify-content-center">
              <button type="submit" class="mt-2 mb-3 d-block update-company-button" id="update-company-button">
                <span>Update Company</span>
              </button>
            </div>
          </form>
        </div>
      </div>
    </div>





    


    
    

    <div class="offcanvas offcanvas-start primary-background-color" tabindex="-1" id="sideBar" aria-labelledby="sideBarLabel">
      <div class="offcanvas-header accent-darken-bg-color">
        <h5 class="offcanvas-title fw-bold text-white" id="sideBarLabel">MENU</h5>
        <button type="button" class="btn-close " data-bs-dismiss="offcanvas" aria-label="Close"></button>
      </div>
      <div class="offcanvas-body p-0 ">
        <ul class="nav d-flex flex-column">

          <li class="nav-item">
            <a class="nav-link py-3 d-flex align-items-center justify-content-between" aria-current="page" href="./admin-dashboard.html">
              <span class="fs-5">Dashboard</span> 
              <i class="bi bi-microsoft fs-5"></i>
            </a>
          </li>
          
          <li class="nav-item">
            <a class="nav-link py-3 d-flex align-items-center justify-content-between" aria-current="page" href="./admin-t-i-o.html">
              <span class="fs-5">Time in/out</span> 
              <i class="bi bi-clock-fill fs-4"></i>
            </a>
          </li>

          <li class="nav-item">
            <a class="nav-link py-3 d-flex align-items-center justify-content-between" aria-current="page" href="./admin-company.html">
              <span class="fs-5">Companies</span> 
              <i class="bi bi-buildings-fill fs-3"></i>
            </a>
          </li>

          <li class="nav-item">
            <a class="nav-link py-3 d-flex align-items-center justify-content-between" aria-current="page" href="./admin-student.html">
              <span class="fs-5">Students</span> 
              <i class="bi bi-mortarboard-fill fs-3"></i>
            </a>
          </li>

          <li class="nav-item">
            <a class="nav-link py-3 d-flex align-items-center justify-content-between" aria-current="page" href="./admin-assistant.html">
              <span class="fs-5">Assistants</span> 
              <i class="bi bi-person-badge fs-3"></i>
            </a>
          </li>


          <li class="nav-item">
            <a class="nav-link py-3 d-flex align-items-center justify-content-between" aria-current="page" href="./admin-incident-report.html">
              <span class="fs-5">Incident Report</span> 
              <i class="bi bi-printer-fill fs-4"></i>
            </a>
          </li>


        </ul>
      </div>
    </div>
    

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.bundle.min.js"
      integrity="sha384-kenU1KFdBIe4zVF0s0G1M5b4hcpxyD9F7jL+jjXkk+Q2h455rYXK/7HAuoJl+0I4"
      crossorigin="anonymous"></script>
    <script src="/js/jQuery.js"></script>
    <script src="/js/jquery.validate.min.js"></script>
    <script type="module" src="/js/firebase-config.js"></script> 
    <script src="/js/index-db-crud.js"></script> 
    <script src="/js/app.js"></script>
    <script src="/js/admin-company.js"></script>





    <script>
      // let uploadedImageBase64 = ""; 

      // document.getElementById('camera-input').addEventListener('change', function (event) {
      //   const file = event.target.files[0];
      //   const previewImage = document.getElementById('preview-image');
      //   const cameraIcon = document.getElementById('camera-icon');

      //   if (file) {
      //     const reader = new FileReader();
      //     reader.onload = function (e) {
      //       previewImage.src = e.target.result;
      //       previewImage.style.display = 'block';
      //       if (cameraIcon) cameraIcon.style.display = 'none';
      //       uploadedImageBase64 = e.target.result; 
      //     };
      //     reader.readAsDataURL(file);
      //   }
      // });
      let uploadedImageBase64 = "";

      // Function to compress images that are too large
      async function compressImageIfNeeded(file) {
        return new Promise((resolve) => {
          if (file.size <= 1 * 1024 * 1024) { // If under 1MB, use as-is
            const reader = new FileReader();
            reader.onload = (e) => resolve(e.target.result);
            reader.readAsDataURL(file);
            return;
          }

          // For images over 1MB, we'll compress them
          const img = new Image();
          const reader = new FileReader();
          
          reader.onload = function(e) {
            img.src = e.target.result;
            
            img.onload = function() {
              // Calculate new dimensions (reduce by 50% initially)
              const canvas = document.createElement('canvas');
              const ctx = canvas.getContext('2d');
              
              // Reduce dimensions while maintaining aspect ratio
              let width = img.width;
              let height = img.height;
              const maxDimension = 1024; // Maximum width or height
              
              if (width > height && width > maxDimension) {
                height = Math.round((height * maxDimension) / width);
                width = maxDimension;
              } else if (height > maxDimension) {
                width = Math.round((width * maxDimension) / height);
                height = maxDimension;
              }
              
              canvas.width = width;
              canvas.height = height;
              ctx.drawImage(img, 0, 0, width, height);
              
              // Reduce quality until under 1MB
              let quality = 0.7; // Start with 70% quality
              canvas.toBlob((blob) => {
                const compressedReader = new FileReader();
                compressedReader.onload = (e) => resolve(e.target.result);
                compressedReader.readAsDataURL(blob);
              }, 'image/jpeg', quality);
            };
          };
          
          reader.readAsDataURL(file);
        });
      }

      document.getElementById('camera-input').addEventListener('change', async function (event) {
        const file = event.target.files[0];
        const previewImage = document.getElementById('preview-image');
        const cameraIcon = document.getElementById('camera-icon');

        if (file) {
          try {
            // Get the image (compressed if necessary)
            const imageData = await compressImageIfNeeded(file);
            
            // Display the image
            previewImage.src = imageData;
            previewImage.style.display = 'block';
            if (cameraIcon) cameraIcon.style.display = 'none';
            
            // Store the Base64 string
            uploadedImageBase64 = imageData;
            
            // Optional: Show a message if image was compressed
            if (file.size > 1 * 1024 * 1024) {
              console.log("Image was compressed to fit size requirements");
              // You could show a toast notification here if you want
            }
          } catch (error) {
            console.error("Error processing image:", error);
            // Handle error (show message to user, etc.)
          }
        }
      });
    </script>



  </body>

</html>